<!DOCTYPE html>
<html lang="ja">
  <head>
    <link rel="stylesheet" href="style.css" >

    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-detector.js"></script>
    <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-handler.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>

    <script src="https://maps.google.com/maps/api/js?key=AIzaSyBbRW4UjBFrgFcU2i9tguU3GbB9KA7MYfw&language=ja"></script>

  </head>





  <p id="sample"></p>
  <a-scene
    vr-mode-ui="enabled: false;"
    loading-screen="enabled: false;"
    arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
    id="scene"
    embedded
    gesture-detector
  >
    <a-marker
      id="animated-marker"
      type="pattern"
      preset="custom"
      url="assets/marker.patt"
      raycaster="objects: .clickable"
      emitevents="true"
      cursor="fuse: false; rayOrigin: mouse;"
      id="markerA"
    >
      <a-image
        src="assets/asset.png"
        scale="1 1 1"
        class="clickable"
        rotation="-90 0 0"
        gesture-handler
      ></a-image>
      <a-text
        id="artext"
        value=""
        color="red"
        rotation="-90 0 0"
        align="center"
        scale="5 5 5"
      ></a-text>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>



    <script>

      $('#fullOverlay').css({
        'display': 'none',
        'z-index': -1
      });




          //  $(function() {
            var count =0;
            var co2 = 200;


            var text = document.getElementById("artext");
        text.setAttribute("value", co2 + " ppm");



      SpeechRecognition = webkitSpeechRecognition || SpeechRecognition;
      const recognition = new SpeechRecognition();
      recognition.continuous = true; // これこれ
      recognition.start();

  //    function foo() {
      recognition.onresult = function (event) {
        var results = event.results;
        for (var i = event.resultIndex; i < results.length; i++) {
          //document.getElementById('result_text').innerHTML = results[i][0].transcript;
          ///var text = document.getElementById("text");
          //text.setAttribute('value', text.getAttribute('input') + ' ppm');
          //                    text.setAttribute('value',results[i][0].transcript);
          ////text.setAttribute("value", "0ppm");

          //chara = (results[i][0].transcript).normalize('NFKC');
          chara = String(results[i][0].transcript);
          console.log(chara);
/*          console.log(chara.length);
          console.log(chara.indexOf( "テスト" ));
          console.log(chara.substring(0,1)-"テ")
          console.log(chara.substring(1,2)-"ス")
          console.log(chara.substring(2,3)-"ト")
          console.log( chara.includes("テスト"));    
             */
          //if (chara.substr( 0, 3 ) === "テスト") {

          //if  ((chara.indexOf( 'テスト' )!=-1)&&(chara.length==3)){
//          if  ((chara.substring(0,1)==="テ")&&(chara.substring(1,2)==="ス")&&(chara.substring(2,3)==="ト")){

 //         if  (chara.includes('テスト')){
            //if  (String(chara) ==('テスト')){
            if  (chara ==('場所表示')){
            console.log("成功");
          //  document.getElementById("sample").innerHTML = "Hello World!";
          //console.log(chara);
            window.location.href = 'map.html';
          }
          //if(chara.length==3){
          if (chara == "データ表示") {
          //  console.log(chara);
          //  document.getElementById("sample").innerHTML = "Hello World!";
            window.location.href = 'chart.html';
           //window.location.href = 'map.html';
          }
        }
        /*
        console.log(chara);
        if (chara == 'テスト') {
          console.log("成功");
          //  console.log(chara);
          //  document.getElementById("sample").innerHTML = "Hello World!";
            window.location.href = 'chart.html';
          }
          */
        co2++;
        console.log(co2);
        var text = document.getElementById("artext");
        text.setAttribute("value", String(chara));
      };
/*      setTimeout(() => {
        foo();
      }, 1000);
    }
    //while (1) {
      co2++;
      text.setAttribute("value", co2 + " ppm");
//}

      const btn3 = document.getElementById('btn3');
      const mask = document.getElementById('mask');
      const modal = document.getElementById('modal');



      btn3.addEventListener('click', () => {
       // mask.classList.remove('hidden');
       // modal.classList.remove('hidden');

        //-----------------------------
        co2 = 888;


        var text = document.getElementById("artext");
        text.setAttribute("value", co2 + " ppm");
        //----------------
        window.location.href = 'chart.html';

      });


        //-----------------
      //mask.addEventListener('click', () => {
        //mask.classList.add('hidden');
        //modal.classList.add('hidden');



 //       $('#fullOverlay').css({
   //     'display': 'block',
     //   'z-index': 2147483647
     // });
      //});

      const btn4 = document.getElementById('btn4');
      btn4.addEventListener('click', () => {
        window.location.href = 'map.html';

      });

*/

</script>
<div id="result"></div>
<div class="btn-container">
  <button id="btn3">ボタン３</button>
  <button id="btn4">ボタン４</button>
</div>
<div id="mask" class="hidden"></div>
<section id="modal" class="hidden">
  <p>ボタン３がクリックされました！</p>
</section>
  </body>
</html>
